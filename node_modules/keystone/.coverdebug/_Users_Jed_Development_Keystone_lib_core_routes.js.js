
// Instrumentation Header
{
    var fs = require('fs');
    var __statement_eAVPo$, __expression_VPQHT0, __block_jqUiAU;
    var store = require('/Users/Jed/Development/Keystone/node_modules/gulp-coverage/contrib/coverage_store.js');
    
    __statement_eAVPo$ = function(i) {
        var fd = store.register('/Users/Jed/Development/Keystone/lib/core/routes.js');
        fs.writeSync(fd, '{"statement": {"node": ' + i + '}},\n');
    }; 
    
    __expression_VPQHT0 = function(i) {
        var fd = store.register('/Users/Jed/Development/Keystone/lib/core/routes.js');
        fs.writeSync(fd, '{"expression": {"node": ' + i + '}},\n');
    }; 
    
    __block_jqUiAU = function(i) {
        var fd = store.register('/Users/Jed/Development/Keystone/lib/core/routes.js');
        fs.writeSync(fd, '{"block": ' + i + '},\n');
    }; 
    __intro_YjKXCJ = function(id, obj) {
        // console.log('__intro: ', id, ', obj.__instrumented_miss: ', obj.__instrumented_miss, ', obj.length: ', obj.length);
        (typeof obj === 'object' || typeof obj === 'function') &&
            Object.defineProperty && Object.defineProperty(obj, '__instrumented_miss', {enumerable: false, writable: true});
        obj.__instrumented_miss = obj.__instrumented_miss || [];
        if ('undefined' !== typeof obj && null !== obj && 'undefined' !== typeof obj.__instrumented_miss) {
            if (obj.length === 0) {
                // console.log('interim miss: ', id);
                obj.__instrumented_miss[id] = true;
            } else {
                obj.__instrumented_miss[id] = false;
            }
        }
        return obj;
    };
    function isProbablyChainable(obj, id) {
        return obj &&
            obj.__instrumented_miss[id] !== undefined &&
            'number' === typeof obj.length;
    }
    __extro_JHNK7m = function(id, obj) {
        var fd = store.register('/Users/Jed/Development/Keystone/lib/core/routes.js');
        // console.log('__extro: ', id, ', obj.__instrumented_miss: ', obj.__instrumented_miss, ', obj.length: ', obj.length);
        if ('undefined' !== typeof obj && null !== obj && 'undefined' !== typeof obj.__instrumented_miss) {
            if (isProbablyChainable(obj, id) && obj.length === 0 && obj.__instrumented_miss[id]) {
                // if the call was not a "constructor" - i.e. it did not add things to the chainable
                // and it did not return anything from the chainable, it is a miss
                // console.log('miss: ', id);
            } else {
                fs.writeSync(fd, '{"chain": {"node": ' + id + '}},\n');
            }
            obj.__instrumented_miss[id] = undefined;
        } else {
            fs.writeSync(fd, '{"chain": {"node": ' + id + '}},\n');
        }
        return obj;
    };
};
////////////////////////

// Instrumented Code
function routes(app) {
    __block_jqUiAU(0);
    {
        __statement_eAVPo$(0);
        this.app = app;
    }
    {
        __statement_eAVPo$(1);
        var keystone = this;
    }
    if (__expression_VPQHT0(2), !this.nav) {
        __block_jqUiAU(1);
        {
            __statement_eAVPo$(3);
            this.nav = __extro_JHNK7m(4, __intro_YjKXCJ(4, this).initNav());
        }
    }
    {
        __statement_eAVPo$(5);
        __extro_JHNK7m(6, __intro_YjKXCJ(6, this).set('view cache', (__expression_VPQHT0(7), __extro_JHNK7m(8, __intro_YjKXCJ(8, this).get('env')) === 'production')));
    }
    if (__expression_VPQHT0(9), __extro_JHNK7m(10, __intro_YjKXCJ(10, this).get('auth')) === true) {
        __block_jqUiAU(2);
        if (__expression_VPQHT0(11), !__extro_JHNK7m(12, __intro_YjKXCJ(12, this).get('signout url'))) {
            __block_jqUiAU(3);
            {
                __statement_eAVPo$(13);
                __extro_JHNK7m(14, __intro_YjKXCJ(14, this).set('signout url', '/keystone/signout'));
            }
        }
        if (__expression_VPQHT0(15), !__extro_JHNK7m(16, __intro_YjKXCJ(16, this).get('signin url'))) {
            __block_jqUiAU(4);
            {
                __statement_eAVPo$(17);
                __extro_JHNK7m(18, __intro_YjKXCJ(18, this).set('signin url', '/keystone/signin'));
            }
        }
        if (__expression_VPQHT0(19), (__expression_VPQHT0(20), !this.nativeApp) || (__expression_VPQHT0(21), !__extro_JHNK7m(22, __intro_YjKXCJ(22, this).get('session')))) {
            __block_jqUiAU(5);
            {
                __statement_eAVPo$(23);
                __extro_JHNK7m(24, __intro_YjKXCJ(24, app).all('/keystone*', this.session.persist));
            }
        }
        {
            __statement_eAVPo$(25);
            __extro_JHNK7m(26, __intro_YjKXCJ(26, app).all('/keystone/signin', (__expression_VPQHT0(27), require('../../routes/views/signin'))));
        }
        {
            __statement_eAVPo$(28);
            __extro_JHNK7m(29, __intro_YjKXCJ(29, app).all('/keystone/signout', (__expression_VPQHT0(30), require('../../routes/views/signout'))));
        }
        {
            __statement_eAVPo$(31);
            __extro_JHNK7m(32, __intro_YjKXCJ(32, app).all('/keystone*', this.session.keystoneAuth));
        }
    } else if (__expression_VPQHT0(33), 'function' === (__expression_VPQHT0(34), typeof __extro_JHNK7m(35, __intro_YjKXCJ(35, this).get('auth')))) {
        __block_jqUiAU(6);
        {
            __statement_eAVPo$(36);
            __extro_JHNK7m(37, __intro_YjKXCJ(37, app).all('/keystone*', __extro_JHNK7m(38, __intro_YjKXCJ(38, this).get('auth'))));
        }
    }
    {
        __statement_eAVPo$(39);
        var initList = function (protect) {
            __block_jqUiAU(7);
            return __expression_VPQHT0(40), function (req, res, next) {
                __block_jqUiAU(8);
                {
                    __statement_eAVPo$(41);
                    req.list = __extro_JHNK7m(42, __intro_YjKXCJ(42, keystone).list(req.params.list));
                }
                if (__expression_VPQHT0(43), (__expression_VPQHT0(44), !req.list) || (__expression_VPQHT0(45), (__expression_VPQHT0(46), protect) && __extro_JHNK7m(47, __intro_YjKXCJ(47, req.list).get('hidden')))) {
                    __block_jqUiAU(9);
                    {
                        __statement_eAVPo$(48);
                        __extro_JHNK7m(49, __intro_YjKXCJ(49, req).flash('error', (__expression_VPQHT0(50), (__expression_VPQHT0(51), 'List ' + req.params.list) + ' could not be found.')));
                    }
                    return __expression_VPQHT0(52), __extro_JHNK7m(53, __intro_YjKXCJ(53, res).redirect('/keystone'));
                }
                {
                    __statement_eAVPo$(54);
                    __expression_VPQHT0(55), next();
                }
            };
        };
    }
    {
        __statement_eAVPo$(56);
        __extro_JHNK7m(57, __intro_YjKXCJ(57, app).all('/keystone', (__expression_VPQHT0(58), require('../../routes/views/home'))));
    }
    if (__extro_JHNK7m(59, __intro_YjKXCJ(59, this).get('email tests'))) {
        __block_jqUiAU(10);
        {
            __statement_eAVPo$(60);
            __extro_JHNK7m(61, __intro_YjKXCJ(61, this).bindEmailTestRoutes(app, __extro_JHNK7m(62, __intro_YjKXCJ(62, this).get('email tests'))));
        }
    }
    if (__extro_JHNK7m(63, __intro_YjKXCJ(63, keystone).get('wysiwyg cloudinary images'))) {
        __block_jqUiAU(11);
        if (__expression_VPQHT0(64), !__extro_JHNK7m(65, __intro_YjKXCJ(65, keystone).get('cloudinary config'))) {
            __block_jqUiAU(12);
            {
                __statement_eAVPo$(66);
                throw new Error('KeystoneJS Initialisaton Error:\n\nTo use wysiwyg cloudinary images, the \'cloudinary config\' setting must be configured.\n\n');
            }
        }
        {
            __statement_eAVPo$(67);
            __extro_JHNK7m(68, __intro_YjKXCJ(68, app).post('/keystone/api/cloudinary/upload', (__expression_VPQHT0(69), require('../../routes/api/cloudinary')).upload));
        }
    }
    if (__extro_JHNK7m(70, __intro_YjKXCJ(70, keystone).get('cloudinary config'))) {
        __block_jqUiAU(13);
        {
            __statement_eAVPo$(71);
            __extro_JHNK7m(72, __intro_YjKXCJ(72, app).get('/keystone/api/cloudinary/get', (__expression_VPQHT0(73), require('../../routes/api/cloudinary')).get));
        }
        {
            __statement_eAVPo$(74);
            __extro_JHNK7m(75, __intro_YjKXCJ(75, app).get('/keystone/api/cloudinary/autocomplete', (__expression_VPQHT0(76), require('../../routes/api/cloudinary')).autocomplete));
        }
    }
    {
        __statement_eAVPo$(77);
        __extro_JHNK7m(78, __intro_YjKXCJ(78, app).all('/keystone/api/:list/:action', (__expression_VPQHT0(79), initList()), (__expression_VPQHT0(80), require('../../routes/api/list'))));
    }
    {
        __statement_eAVPo$(81);
        __extro_JHNK7m(82, __intro_YjKXCJ(82, app).all('/keystone/download/:list', (__expression_VPQHT0(83), initList()), (__expression_VPQHT0(84), require('../../routes/download/list'))));
    }
    {
        __statement_eAVPo$(85);
        __extro_JHNK7m(86, __intro_YjKXCJ(86, app).all('/keystone/:list/:page([0-9]{1,5})?', (__expression_VPQHT0(87), initList(true)), (__expression_VPQHT0(88), require('../../routes/views/list'))));
    }
    {
        __statement_eAVPo$(89);
        __extro_JHNK7m(90, __intro_YjKXCJ(90, app).all('/keystone/:list/:item', (__expression_VPQHT0(91), initList(true)), (__expression_VPQHT0(92), require('../../routes/views/item'))));
    }
    return __expression_VPQHT0(93), this;
}
{
    __statement_eAVPo$(94);
    module.exports = routes;
}